<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>약복용량 계산기</title>
    <style>
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>약복용량 계산기</h1>
    
    <label for="functionSelect">함수를 선택하세요:</label>
    <select id="functionSelect" onchange="showInputFields()">
        <option value="">선택</option>
        <option value="med_name1">약_이름 1</option>
        <option value="med_name2">약_이름 2</option>
        <option value="med_name3">약_이름 3</option>
        <option value="med_name4">약_이름 4</option>
        <option value="med_name5">약_이름 5</option>
        <option value="med_name6">약_이름 6</option>
        <option value="med_name7">약_이름 7</option>
        <option value="med_name8">약_이름 8</option>
        <option value="med_name9">약_이름 9</option>
        <option value="med_name10">약_이름 10</option>
    </select>

    <div id="inputFields" class="hidden">
        <label for="variable1">키:</label>
        <input type="number" id="variable1" placeholder="변수 1 입력"><br>

        <label for="variable2">몸무게:</label>
        <input type="number" id="variable2" placeholder="변수 2 입력"><br>

        <label for="variable3">나이:</label>
        <input type="number" id="variable3" placeholder="변수 3 입력"><br>
    </div>

    <button onclick="calculateDosage()">계산</button>

    <h2>약복용량: <span id="dosageResult">0</span></h2>

    <script>
        function showInputFields() {
            const selectedFunction = document.getElementById('functionSelect').value;

            // 입력 필드 보이기/숨기기
            const inputFields = document.getElementById('inputFields');
            inputFields.classList.toggle('hidden', selectedFunction === '');
        }

        function calculateDosage() {
            const selectedFunction = document.getElementById('functionSelect').value;
            const variable1 = parseFloat(document.getElementById('variable1').value);
            const variable2 = parseFloat(document.getElementById('variable2').value);
            const variable3 = parseFloat(document.getElementById('variable3').value);

            // AJAX 호출
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "calculate", true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    document.getElementById('dosageResult').innerText = xhr.responseText;
                }
            };
            xhr.send(`function=${selectedFunction}&var1=${variable1}&var2=${variable2}&var3=${variable3}`);
        }
    </script>
</body>
</html>
